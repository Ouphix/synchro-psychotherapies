setwd("/Users/Ofix/Documents/Fac/internat/Recherche/projets/synchro/synchroData/Git/INCANT/")
library("lme4")
library("plyr")
library("stringr")
FullnameList <- list.files("Data/CSV/MotionHistory/raw", full.names=TRUE)
filesList <- list.files("Data/CSV/MotionHistory/raw", full.names=FALSE)
indexList <- c()
for (i in filesList){
a <- str_count(i)-17
name <- substr(i, 1, a)
indexList <- c(indexList, name)
}
importdata <-function(FullnameList){
data <- c()
for (i in FullnameList){
dataAlone <- read.csv(i)
mydata.nas <- apply(dataAlone, 1, function(x){all(is.na(x))})
dataAlone <- dataAlone[!mydata.nas,]
data <- rbind(data, dataAlone)
}
return (data)
}
data <- importdata(FullnameList)
MeanMotionByTime <- function(subject, indexOfvideos=1:NumberOfvideos, interval, data){
x <- c()
for (file in indexList[indexOfvideos]){
dataVector <- data[which(data$indexList==file), subject]
## with ceiling : superior limit of the round
IntervalNumbersVideo <- ceiling(length(dataVector)/interval)
for (i in 1:IntervalNumbersVideo){
borneinf<- 1+(i-1)*interval
bornesup <-i*interval
dataVectorInterval <- dataVector[borneinf:bornesup]
mean <- mean(dataVectorInterval, na.rm=TRUE)
x <- c(x, mean)}}
return (x)}
SlidingInterval <- function(subject, indexOfvideos=1:NumberOfvideos, interval, data)
{x <- c()
for (file in indexList[indexOfvideos]){
dataVector <- data[which(data$indexList==file), subject]
NBofAnalysedFrames <- length(dataVector)-interval+1
for (i in 1:NBofAnalysedFrames){
borneinf<- (i)
bornesup <-(interval-1+i)
dataVectorInterval <- dataVector[borneinf:bornesup]
mean <- mean(dataVectorInterval, na.rm=TRUE)
x <- c(x, mean)}}
return (x)}
labelvideolist  <-c()
for (i in indexList){
a <- str_count(i)
name <- substr(i, 6, a)
labelvideolist <- c(labelvideolist, name)
}
FilesName <- data.frame(unique(data$file), filesList, indexList, labelvideolist)
NumberOfvideos <- length(indexList)
colOrderList <- c("blue","red", "green","orange")
ParticipantsList <- c("father", "mother", "patient", "therapist")
data <- merge(data, FilesName, by.x="file", by.y="unique.data.file.", all=TRUE)
data$timeMin <- data$frame/(25*60)
data$logFather <- log(data$father)
data$norm.logFather <- data$logFather+20
data$norm.logFather[which(data$norm.logFather==-Inf)] <- 0
str(data$norm.logFather)
sort(data$norm.logFather)
hist(data$norm.logFather)
data$logFather <- log(data$father)
data$norm.logFather <- data$logFather+20
data$norm.logFather[which(data$norm.logFather==-Inf)] <- NA
str(data$norm.logFather)
hist(data$norm.logFather)
data$logMother <- log(data$mother)
hist(data$logMother)
data$norm.logMother <- data$logMother+20
data$norm.logMother[which(data$norm.logMother==-Inf)] <- NA
hist(data$norm.logMother)
str(data$norm.logFather)
sort(data$norm.logFather)
data$logPatient <- log(data$patient)
hist(data$logPatient)
data$norm.logPatient <- data$logPatient+20
data$norm.logPatient[which(data$norm.logPatient==-Inf)] <- NA
hist(data$norm.logPatient)
str(data$norm.logPatient)
sort(data$norm.logPatient)
data$logTherapist <- log(data$therapist)
hist(data$logTherapist)
data$norm.logTherapist <- data$logTherapist+20
data$norm.logTherapist[which(data$norm.logTherapist==-Inf)] <- NA
hist(data$norm.logTherapist)
data$file <- NULL
data$filesList <- NULL
hist(data$father)
hist(data$norm.logFather)
hist(data$mother)
hist(data$norm.logMother)
hist(data$patient)
hist(data$norm.logPatient)
hist(data$therapist)
hist(data$norm.logTherapist)
hist(data$therapist)
hist(data$norm.logTherapist)
hist(data$father, col=ParticipantsList[1])
col0rderList
colOrderList
colOrderList  <- c("blue","red", "green","orange")
ParticipantsList <- c("father", "mother", "patient", "therapist")
hist(data$father, col=colOrderList[1])
hist(data$norm.logFather, col=colOrderList[1])
hist(data$mother, col=colOrderList[2])
hist(data$norm.logMother, col=colOrderList[2])
hist(data$patient, col=colOrderList[3])
hist(data$norm.logPatient, col=colOrderList[3])
hist(data$therapist, col=colOrderList[4])
hist(data$norm.logTherapist, col=colOrderList[4])
data$logMother <- log(data$mother)
data$norm.logMother <- data$logMother+20
data$norm.logMother[which(data$norm.logMother==-Inf)] <- NA
hist(data$mother, col=colOrderList[2])
hist(data$norm.logMother, col=colOrderList[2])
data$logMother <- log(data$mother)
hist(data$logMother)
data$norm.logMother <- data$logMother+20
data$norm.logMother[which(data$norm.logMother==-Inf)] <- 0
hist(data$mother, col=colOrderList[2])
hist(data$norm.logMother, col=colOrderList[2])
data$logMother <- log(data$mother)
data$norm.logMother <- data$logMother+20
data$norm.logMother[which(data$norm.logMother==-Inf)] <- NA
hist(data$mother, col=colOrderList[2])
hist(data$norm.logMother, col=colOrderList[2])
data$file <- NULL
data$filesList <- NULL
str(data)
summary(data)
videoLengthList <-c()
for (i in indexList){
index <- which(data$indexList==i)
videolength <- max(data$timeMin[index])
videoLengthList <-c(videoLengthList,videolength)}
par(mar=c(4,4,3,1))
barplot(videoLengthList, col="cornflowerblue", cex.axis=0.6, cex.names=0.4,
ylab="Minutes", xlab="Video Name", las=2, names=labelvideolist,
main="Length in each F1044 video (min)")
abline(h = mean(videoLengthList), lwd=2, lty=2)
text(15,25, "Mean")
par(mar=c(4,4,3,1))
barplot(videoLengthList, col="cornflowerblue", cex.axis=0.6, cex.names=0.4,
ylab="Minutes", xlab="Video Name", las=2, names=labelvideolist,
main="Length in each F1044 video (min)")
abline(h = mean(videoLengthList), lwd=2, lty=2)
text(7,25, "Mean")
par(mar=c(4,4,3,1))
barplot(videoLengthList, col="cornflowerblue", cex.axis=0.6, cex.names=0.4,
ylab="Minutes", xlab="Video Name", las=2, names=labelvideolist,
main="Length in each F1044 video (min)")
abline(h = mean(videoLengthList), lwd=2, lty=2)
text(3,25, "Mean")
par(mar=c(4,4,3,1))
barplot(videoLengthList, col="cornflowerblue", cex.axis=0.6, cex.names=0.4,
ylab="Minutes", xlab="Video Name", las=2, names=labelvideolist,
main="Length in each F1044 video (min)")
abline(h = mean(videoLengthList), lwd=2, lty=2)
text(1,25, "Mean")
par(mar=c(4,4,3,1))
barplot(videoLengthList, col="cornflowerblue", cex.axis=0.6, cex.names=0.4,
ylab="Minutes", xlab="Video Name", las=2, names=labelvideolist,
main="Length in each F1044 video (min)")
abline(h = mean(videoLengthList), lwd=2, lty=2)
text(1,27, "Mean")
barplot(table(data$labelvideolist), col="cornflowerblue", cex.axis=0.6, cex.names=0.5, cex.lab=0.8,
main="Number of frames in each F1044 video", cex.main=0.8, ylab="Frame number",
names = labelvideolist, xlab="Video Name", las=1)
abline(h = mean(table(data$labelvideolist)), lwd=2, lty=2)
text(15,38000, "Mean")
barplot(table(data$labelvideolist), col="cornflowerblue", cex.axis=0.6, cex.names=0.5, cex.lab=0.8,
main="Number of frames in each F1044 video", cex.main=0.8, ylab="Frame number",
names = labelvideolist, xlab="Video Name", las=1)
abline(h = mean(table(data$labelvideolist)), lwd=2, lty=2)
text(1,38000, "Mean")
barplot(table(data$labelvideolist), col="cornflowerblue", cex.axis=0.6, cex.names=0.5, cex.lab=0.8,
main="Number of frames in each F1044 video", cex.main=0.8, ylab="Frame number",
names = labelvideolist, xlab="Video Name", las=1)
abline(h = mean(table(data$labelvideolist)), lwd=2, lty=2)
text(1,39000, "Mean")
tab <- cbind(table(is.na(data$father)),table(is.na(data$mother)),table(is.na(data$patient)), table(is.na(data$therapist)))
par(mar=c(4,4,5,1))
barplot(tab, cex.axis = 0.7, las=2, names=ParticipantsList,
main="Number of available data by participant",
beside=TRUE, las=1, col=terrain.colors(2), ylim=c(0,650000),
ylab="Available data (non NA)", xlab="Participants")
legend("top", c("T", "F"), fill=terrain.colors(2))
meanMotionList <-c()
meanMotion <- function(subject){
for (i in indexList){
index <- which(data$indexList==i)
Motionsubject<- mean(data[index,subject], na.rm=TRUE)
meanMotionList <-c(meanMotionList, Motionsubject)}
return (meanMotionList)}
Motionfatherlist <- meanMotion("father")
MotionMotherList <- meanMotion("mother")
MotionTherapistList <- meanMotion("therapist")
MotionPatientList <- meanMotion("patient")
MotionMeanList <- rbind(Motionfatherlist, MotionMotherList, MotionPatientList, MotionTherapistList)
par(mar=c(4,4,2,1))
barplot(MotionMeanList, names=labelvideolist, las=2, cex.axis = 0.6, cex.names=0.6,
main="Mean Motion history in each video", beside=TRUE,
col=colOrderList, ylab="Mean motion history", xlab="Video index")
par(mar=c(1,0.5,0.5,1))
legend("top", inset=.05, ParticipantsList,
fill=colOrderList, cex=0.7)
par(mar=c(4,4,2,2))
boxplot(data$father, data$mother, data$therapist, data$patient,
col=colOrderList,
names=ParticipantsList,
main= "Box plots of the Motion history by frame (raw data), all videos", las=1, ylab="Motion history", xlab="Participant")
par(mar=c(1,0.5,0.5,1))
legend("topleft", ParticipantsList, fill=colOrderList, cex=0.7)
str(data)
par(mar=c(4,4,2,2))
boxplot(data$norm.logFather, data$norm.logMother, data$norm.logTherapist, data$norm.logPatient,
col=colOrderList,
names=ParticipantsList,
main= "Box plots of the Motion history by frame (raw data), all videos", las=1, ylab="Motion history", xlab="Participant")
par(mar=c(1,0.5,0.5,1))
legend("topleft", ParticipantsList, fill=colOrderList, cex=0.7)
par(mar=c(4,4,2,2))
boxplot(data$norm.logFather, data$norm.logMother, data$norm.logPatient, data$norm.logTherapist,
col=colOrderList,
names=ParticipantsList,
main= "Box plots of the Motion history by frame (raw data), all videos", las=1, ylab="Motion history", xlab="Participant")
par(mar=c(1,0.5,0.5,1))
legend("topleft", ParticipantsList, fill=colOrderList, cex=0.7)
par(mar=c(4,4,2,2))
boxplot(data$father, data$mother, data$therapist, data$patient,
col=colOrderList,
names=ParticipantsList,
main= "Box plots of the Motion history by frame (raw data), all videos", las=1, ylab="Motion history", xlab="Participant")
par(mar=c(1,0.5,0.5,1))
legend("topleft", ParticipantsList, fill=colOrderList, cex=0.7)
par(mar=c(4,4,2,2))
boxplot(data$norm.logFather, data$norm.logMother, data$norm.logPatient, data$norm.logTherapist,
col=colOrderList,
names=ParticipantsList,
main= "Box plots of the Motion history by frame (raw data), all videos", las=1, ylab="Motion history", xlab="Participant")
par(mar=c(1,0.5,0.5,1))
legend("topleft", ParticipantsList, fill=colOrderList, cex=0.7)
dFather <- density(data$father, na.rm=TRUE)
dMother <- density(data$mother, na.rm=TRUE)
dPatient <- density(data$patient, na.rm=TRUE)
dTherapist <- density(data$therapist, na.rm=TRUE)
par(mar=c(4,4,2,2))
plot(dFather, main="Kernel density plot", col=colOrderList[1])
lines(dMother,col=colOrderList[2])
lines(dPatient,col=colOrderList[3])
lines(dTherapist,col=colOrderList[4])
par(mar=c(1,0.5,0.5,1))
legend("topright", ParticipantsList, fill=colOrderList, cex=0.7)
par(mar=c(4,4,2,2))
boxplot(data$norm.logFather, data$norm.logMother, data$norm.logPatient, data$norm.logTherapist,
col=colOrderList,
names=ParticipantsList,
main= "Box plots of the Motion history by frame (raw data), all videos", las=1, ylab="Motion history", xlab="Participant")
par(mar=c(1,0.5,0.5,1))
legend("topleft", ParticipantsList, fill=colOrderList, cex=0.7)
par(mar=c(3,3,2,2))
boxplot(data$logFather, data$logMother, data$logTherapist, data$logPatient,
col=colOrderList,
names=ParticipantsList,
main= "Box plots of the log of the motion history by frame (raw data), all videos", las=1)
par(mar=c(1,0.5,0.5,1))
legend("topleft", ParticipantsList, fill=colOrderList, cex=0.7)
str(data)
dlogFather <- density(data$norm.logFather, na.rm=TRUE)
dlogMother <- density(data$norm.logMother, na.rm=TRUE)
dlogPatient <- density(data$norm.logPatient, na.rm=TRUE)
dlogTherapist <- density(data$norm.logTherapist, na.rm=TRUE)
par(mar=c(4,4,2,2))
plot(dlogFather, main="Kernel density plot", col=colOrderList[1])
lines(dlogMother,col=colOrderList[2])
lines(dlogPatient,col=colOrderList[3])
lines(dlogTherapist,col=colOrderList[4])
par(mar=c(1,0.5,0.5,1))
legend("topright", ParticipantsList, fill=colOrderList, cex=0.7)
hist(data$norm.logFather, col=colOrderList[1])
hist(data$norm.logMother, col=colOrderList[2])
hist(data$norm.logPatient, col=colOrderList[3])
hist(data$norm.logTherapist, col=colOrderList[4])
par(mar=c(4,4,2,2))
hist(data$norm.logFather, col=colOrderList[1])
hist(data$norm.logMother, col=colOrderList[2])
hist(data$norm.logPatient, col=colOrderList[3])
hist(data$norm.logTherapist, col=colOrderList[4])
